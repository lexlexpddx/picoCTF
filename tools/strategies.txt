General strategies for CTF

1. Use "file" command for every new file to view file data
2. Search for strings using string | grep pipe
3. Binwalk will search binary images for embedded files and exe codes
4. Use exiftool to find metadata information for file
5. Cyberchef allows for all kinds of conversions
6. Use zsteg for analyzing images to find hidden data (steganography)
7. Remember that you can often redirect output to a file of your choice and then look at it that way!!
8. You can use "find" to find a file in a hierarchy
	- find . -name file.txt

Disk Analysis
1. Main layers of disk images:
	1. Media
		- All media layer tools start with "mm"
		- use mmls to get the partition table of the image and other info
		- Lowest level, provides access info for deeper layers
	2. Block
		- second lowest level
		- All Block layer tools start with "blk"
		- blkcat will give contents of a single block
		- All broken into equal-sized chunks
	3. Inode
		- This is the bookkeeping layer of the image
		- Tools for this layer start with "i"
		- Kinda works like a table of contents
		- icat is like cat for the filename layer, but outputs the contents of a file based on 
		  the inode number
			- when using icat, you can extract a file like this:
				- icat -o 123456 file.img 123 > output.txt
				- then if that is encrypted, run openssl on it
	4. Filename
		- This is the layer the user usually sees
		- Most interactions with the filename layer use regular shell commands
		- All tools for this layer start with "f"
		
1. Sleuthkit
	- To solve problems with an instance, use the given access checker program
	- If asked for length in sectors: use the information from the file command
	- Netcat (NC)
		- Can be used for TCP, UDP
		- TCP (Transmission Control Protocol)
			- Enables programs and devices to exchange messages over a network
			- Can send packets across the internet
			- Very common usage and ensures end-to-end data delivery
				- Delivered in send order and not corrupted
			- Is a connection-oriented protocol
			- Used by SSH, FTP, SB/CIFS
			- Is protocol number 0x6 in the IP suite
		- UDP (User Datagram Protocol)
			- Connectionless protocol
			- Often used for streaming media
				- This is because mis-ordering and minor packet loss is acceptable with these services
			- Used for DNS, DHCP
			- Is protocol number 0x11 in the IP suite
		- Typically in the following format:
			- nc <destination> port
			- Ex: nc saturn.picoctf.net 52279
	- fls
		- use "-o" for sector offset
		- Look for linux, or other os systems as clues
		- You can also look for largest partitions with uneven lengths as clues forwhere to start
		- fls will dump all top-level directories of the disk image
		- Look at folders that have user influece, like root and home
		- If a file or folder as (realloc) that means it has been deleted or moved

Metadata

1. When looking for metadata, look at all pieces (use exiftool) to see if there is anything funky


Base64-encoded strings

1. Always a multiple of 4
	- use echo piped through wc to count the number of chars in a string
	- ex: echo -n "cGljb0NURnt0aGVfbTN0YWRhdGFfMXNfbW9kaWZpZWR9" | wc -m
		- "-n" prevents newline
		- wc counts lines, words, chars, etc (-m is chars)
2. Only uses "A" to "Z", "a" to "z", "0" to "9", and "+" "/"
3. End of a string can be padded up to two times using the "=" char (allowed at end only)
4. Use cyberchef to decode potential Base64-encoded strings
	- Two other options for decoding Base64-encoded strings:
		- base64 -d <<< string
			- "-d" is the flag for decode
		- openssl base64 -d <<< string
5. Using base64 command

Openssl
1. Openssl encrypts files using various encryption schemes
2. Usually formatted like this:
	- openssl <encryption scheme> -d -in <file_to_decrypt> -out <output_file>
	- "-d" allows a decrypt
	- you can also use -k to put in the password, or it will prompt 

Packet Analysis
1. Also known as network analysis
	- Understand what has happened on a network through analyzing captured packets
	- We will use wireshark
2. How to use packet analysis
	- Packet analysis is all about filtering
	- You can almost always filter out ARP (Address resolution protocol) messages because these are messages that just relate to IP addresses and hardware addresses
	- Filtering with wireshark
		- To filter out, go to the filter line and use "!" and the filter you want to apply
		- Example: If I want to filter out ARP messages, I would use !arp
